  The past few years have witnessed unprecedented rapid improvement of the performance of a new class of photovoltaics based on halide perovskites. This progress has been achieved even though there is no generally accepted mechanism of the operation of these solar cells. Here we present a model based on bistable amphoteric native defects that accounts for all key characteristics of these photovoltaics and explains many idiosyncratic properties of halide perovskites. We show that a transformation between donor-like and acceptor-like configurations leads to a resonant interaction between amphoteric defects and free charge carriers. This interaction , combined with the charge transfer from the perovskite to the electron and hole transporting layers results in the formation of a dynamic n-i-p junction whose photovoltaic parameters are determined by the perovskite absorber. The model provides a unified explanation for the outstanding properties of the perovskite photovoltaics , including hysteresis of J-V characteristics and ultraviolet light-induced degradation.