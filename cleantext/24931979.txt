  Metabolites , small molecules that are involved in cellular reactions , provide a direct functional signature of cellular state. Untargeted metabolomics experiments usually rely on tandem mass spectrometry to identify the thousands of compounds in a biological sample. Recently , we presented CSI: FingerID for searching in molecular structure databases using tandem mass spectrometry data. CSI: FingerID predicts a molecular fingerprint that encodes the structure of the query compound , then uses this to search a molecular structure database such as PubChem. Scoring of the predicted query fingerprint and deterministic target fingerprints is carried out assuming independence between the molecular properties constituting the fingerprint. We present a scoring that takes into account dependencies between molecular properties. As before , we predict posterior probabilities of molecular properties using machine learning. Dependencies between molecular properties are modeled as a Bayesian tree network; the tree structure is estimated on the fly from the instance data. For each edge , we also estimate the expected covariance between the two random variables. For fixed marginal probabilities , we then estimate conditional probabilities using the known covariance. Now , the corrected posterior probability of each candidate can be computed , and candidates are ranked by this score. Modeling dependencies improves identification rates of CSI: FingerID by 2.85 percentage points. The new scoring Bayesian ( fixed tree) is integrated into SIRIUS 4.0 ( https://bio.informatik.uni-jena.de/software/sirius/).