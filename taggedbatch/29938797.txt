 In image-guided radiation therapy , fiducial markers or clips are often used to determine the position of the tumor. These markers lead to streak artifacts in cone-beam CT ( CBCT) scans. Standard inpainting-based metal artifact reduction ( MAR) methods fail to remove these artifacts in cases of large motion. We propose two methods to effectively reduce artifacts caused by moving metal inserts. The first method ( MMAR) utilizes a coarse metal segmentation in the image domain and a refined segmentation in the rawdata domain. After an initial reconstruction , metal is segmented and forward projected giving a coarse metal mask in the rawdata domain. Inside the coarse mask , metal is segmented by utilizing a 2D Sobel filter. Metal is removed by linear interpolation in the refined metal mask. The second method ( MoCoMAR) utilizes a motion compensation ( MoCo) algorithm ( Med Phys. 2013; 40:101913) that provides us with a motion-free volume ( 3D) or with a time series of motion-free volumes ( 4D). We then apply the normalized metal artifact reduction ( NMAR) ( Med Phys. 2010; 37:5482-5493) to these MoCo volumes. Both methods were applied to three CBCT data sets of patients with metal inserts in the thorax or abdomen region and a 4D thorax simulation. The results were compared to volumes corrected by a standard MAR1 ( Radiology. 1987; 164:576-577). MMAR and MoCoMAR were able to remove all artifacts caused by moving metal inserts for the patients and the simulation. Both new methods outperformed the standard MAR1 , which was only able to remove artifacts caused by metal inserts with little or no motion. In this work , two new methods to remove artifacts caused by moving metal inserts are introduced. Both methods showed good results for a simulation and three patients. While the first method ( MMAR) works without any prior knowledge , the second method ( MoCoMAR) requires a respiratory signal for the MoCo step and is computationally more demanding and gives no benefit over MMAR , unless MoCo images are desired.