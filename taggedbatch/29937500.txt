 More and more Internet of Things ( IoT) wireless devices have been providing ubiquitous services over the recent years. Since most of these devices are powered by batteries , a fundamental trade-off to be addressed is the depleted energy and the achieved data throughput in wireless data transmission. By exploiting the rate-adaptive capacities of wireless devices , most existing works on energy-efficient data transmission try to design rate-adaptive transmission policies to maximize the amount of transmitted data bits under the energy constraints of devices. Such solutions , however , can not apply to scenarios where data packets have respective deadlines and only integrally transmitted data packets contribute. Thus , this paper introduces a notion of weighted throughput , which measures how much total value of data packets are successfully and integrally transmitted before their own deadlines. By designing efficient rate-adaptive transmission policies , this paper aims to make the best use of the energy and maximize the weighted throughput. What is more challenging but with practical significance , we consider the fading effect of wireless channels in both offline and online scenarios. In the offline scenario , we develop an optimal algorithm that computes the optimal solution in pseudo-polynomial time , which is the best possible solution as the problem undertaken is NP-hard. In the online scenario , we propose an efficient heuristic algorithm based on optimal properties derived for the optimal offline solution. Simulation results validate the efficiency of the proposed algorithm.