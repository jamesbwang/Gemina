 Multicompartment microcapsules , with each compartment protected by a distinct stimuli-responsive shell for versatile controlled release , are highly desired for developing new-generation microcarriers. Although many multicompartmental microcapsules have been created , most can not combine different release styles to achieve flexible programmed sequential release. Here , one-step template synthesis of controllable Trojan-horse-like stimuli-responsive microcapsules is reported with capsule-in-capsule structures from microfluidic quadruple emulsions for diverse programmed sequential release. The nested inner and outer capsule compartments can separately encapsulate different contents , while their two stimuli-responsive hydrogel shells can individually control the content release from each capsule compartment for versatile sequential release. This is demonstrated by using three types of Trojan-horse-like stimuli-responsive microcapsules , with different combinations of release styles for flexible programmed sequential release. The proposed microcapsules provide novel advanced candidates for developing new-generation microcarriers for diverse , efficient applications.